tombraiders.net item & enemy statistics
=======================================
Bookmarkable JavaScript code to run on any individual walkthrough or overview page of tombraiders.net to see how many enemies, pick-ups, secrets, etc. a level has.

How to use
----------------
Create a new bookmark and put the following text in the URL field.
```
javascript:(function(){var xx={};xx.c=function(){var e=["enemy","item","secret","gold","silver"],t={gunmen:"gunman",men:"men",mummies:"mummy",switches:"switch",tribesmen:"tribesman",wolves:"wolf"};return{classesToAggregate:e,plurals:t}}(),xx.s=function(){var e=function(e){return"span."+e},t=function(){return'[class^="walk-table"] a[href^="walks/"]'};return{entityClass:e,walkthroughLinks:t}}(),xx.j=function(){var e=function(e){var t=0,n=function(){return t++,"undefined"!=typeof jQuery?void e():void(100>t?setTimeout(n,100):console.error("Could not load jQuery!"))};if("undefined"==typeof jQuery){delete $;var r=document.createElement("script");r.src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.3/jquery.min.js",document.getElementsByTagName("head")[0].appendChild(r),n()}else e()};return{loadJquery:e}}(),xx.t=function(){var e=function(e){return e.match(/^secret #\d+$/i)?"secret":e.replace(/^\W+/,"").replace(/\W+$/,"").trim().toLowerCase()},t=function(t){if(t=e(t),""===t)return{name:"",number:0};var n=t.match(/^(\d+) (.*)$/);if(n)return{number:parseInt(n[1]),name:n[2]};var r=["one","two","three","four","five","six"],i=new RegExp("^("+r.join("|")+")\\s(.*?)$"),a=t.match(i);return a?(r.unshift(0),{name:a[2],number:r.indexOf(a[1])}):{name:t,number:1}},n=function(e,t){if(e=e.toLowerCase(),"undefined"!=typeof xx.c.plurals[e])return xx.c.plurals[e];if("s"===e.substr(e.length-1)){var n=e.substr(0,e.length-1);if("undefined"!=typeof t[n])return n}return e},r=function(){var e=["first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth"],t=["the","a"],n=["more","additional","another","other","sets of","boxes of","bunches of","bundles of"],r=function(e){return"("+e.join("\\s|")+"\\s)"};return new RegExp("^("+r(n)+"|"+r(t)+"?"+r(e)+"?)?(.*?)$","i")},i=function(e,t){var i=e.match(r()),a=i?i[i.length-1]:e;return a=n(a,t),a!==e&&(console.log(e+" renamed to "+a),"undefined"!=typeof t[a]?t[a]+=t[e]:t[a]=t[e],delete t[e]),t},a=function(e){var t=e;for(var n in e)e.hasOwnProperty(n)&&(t=i(n,t));return t};return{getSemanticInfo:t,mergeEntities:a}}(),xx.d=function(){var e=function(e,t){t=t||document;var n={};return $.each($(xx.s.entityClass(e),t),function(){var e=xx.t.getSemanticInfo($(this).text());""!==e.name&&("undefined"==typeof n[e.name]?n[e.name]=e.number:n[e.name]+=e.number)}),xx.t.mergeEntities(xx.t.mergeEntities(n))},t=function(e){$.each($(xx.s.walkthroughLinks()),function(){var t=$(this);$.get(t.attr("href"),{},function(n){n=n.replace(/<img/g,"<cheese");var r=$(n);e(r,t)},"html")})};return{fetchEntities:e,loadAllWalkthroughs:t}}(),xx.b=function(){var e=function(){var e=$("#wrap");if(0===e.length&&(e=$("#LayoutDiv1"),0===e.length))throw new Error("Could not get base element!");return e},t=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},n=function(e){var t=e.split("/");return"ctr_"+t[t.length-1].split(".")[0]},r=function(t){var r=n(t.attr("href"));e().before('<div id="'+r+'"><h1>'+t.text()+"</h1></div>");var i=$("#"+r);return $("#"+r).find("h1").click(function(){i.find("h2, table").toggle()}),i},i=function(){return{attr:function(){return"results"},text:function(){return"Statistics"}}},a=function(e){var t=n(e.attr("href")),i=$("#"+t);return 0===i.length&&(i=r(e)),i},o=function(e){return"sec_"+e},u=function(e,t,n){var r=a(t);r.append('<div class="'+e+'"><h2>'+n+"</h2><table></table></div>")},s=function(e,n){n=n||i();var r=a(n),s=o(e),c=r.find("."+s);return 0===c.length&&(u(s,n,t(e)),c=r.find("."+s)),c},c=function(){e().prevAll("div").remove()};return{createContainer:r,getSection:s,removeAll:c}}(),xx.e=function(){var e=function(e){var t="";return e.html&&(t+='style="'+e.html+'"'),e["class"]&&(t+=' class="'+e["class"]+'"'),t=t.trim(),0===t.length?"":" "+t},t=function(t,n,r){for(var i in n)n.hasOwnProperty(i)&&t.append($("<tr"+e(r)+">").append("<td>"+i+'</td><td style="text-align: right">'+n[i]+"</td>"))},n=function(e){e.html("<tr><th>Type</th><th>Total</th></tr>")},r=function(e,r,i){var a=xx.b.getSection(r,i),o=a.find("table");n(o),t(o,e,{"class":r}),0===o.find("td").length&&a.remove()};return{displayEntities:r}}(),xx.r=function(){var e=function(){for(var e=0;e<xx.c.classesToAggregate.length;e++){var t=xx.c.classesToAggregate[e];xx.e.displayEntities(xx.d.fetchEntities(t),t)}},t=function(e,t){for(var n=0;n<xx.c.classesToAggregate.length;n++){var r=xx.c.classesToAggregate[n],i=xx.d.fetchEntities(r,e);xx.e.displayEntities(i,r,t)}},n=function(){xx.d.loadAllWalkthroughs(function(e,n){xx.b.createContainer(n),t(e,n)})};return{singlePageRunner:e,overviewPageRunner:n}}(),xx.j.loadJquery(function(){$(xx.s.walkthroughLinks()).length>0?xx.r.overviewPageRunner():xx.r.singlePageRunner()});})();
```

Click on the bookmark on any tombraiders.net walkthrough or overview page. (For example on the page for Tomb Raider Underworld's [Bhogavati walkthrough](http://tombraiders.net/stella/walks/TR8walk/07bhogavati.html) or on the [Tomb Raider II overview](http://tombraiders.net/stella/tomb2.html).)

Status
--------
Still needs a lot of work.